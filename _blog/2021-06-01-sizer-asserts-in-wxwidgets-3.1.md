---
title: "Sizer Asserts in wxWidgets 3.1"
date: 2021-06-01
tags:
- debug
- sizers
- change
comments: true
---

When updating an existing application to wxWidgets 3.1, you may encounter new
assertion failures in the code which seemed to work fine previously, with
older wxWidgets versions. For example, a message box telling you that "only
horizontal alignment flags can be used in vertical sizers" when adding an
element to a `wxBoxSizer` or that "wxEXPAND flag will be overridden by
alignment flags" when doing it with a `wx(Flex)GridSizer` might pop up where
previously nothing was shown. What's going on here and what should you do
about it?

These asserts are indeed new in wxWidgets 3.1 and were added to help you to
detect incorrect use of the sizer flags to avoid head-scratching moments when
you wonder why exactly is `wxEXPAND` you had specified doesn't seem to have
any effect -- now you're immediately going to get the message above when
developing that will hopefully save you time and frustration. However, unlike
most other asserts, that usually indicate a serious problem in the program,
these asserts can be safely ignored because they only warn you about the sizer
flags not having the effect that you might expect them to have, but nothing
catastrophic happens if you just continue running the program after them.

Moreover, these asserts, as all the other ones, are only useful to the program
developers, not its users. Of course, in theory, the users are never supposed
to see them at all because the production versions of the program should be
built with `NDEBUG` defined, as explained in the [debugging overview][1] in
the manual, but in practice many projects forget to do it and thus asserts
remain active even in the production (also known as "release") builds. This is
a more general problem that you should definitely address in your project
build system in any case, but in the meanwhile, if you're using such a project
and can't modify its build system to rebuild it with `NDEBUG`, we have
provided, since the [commit 1d6c740f3b][2] (Disable sizer flag checks if
WXSUPPRESS_SIZER_FLAGS_CHECK is set, 2021-05-20), which will be included in
wxWidgets 3.1.6 release, an escape hatch allowing to avoid these asserts if
you're not the program developer and these asserts are just annoying, rather
than useful, to you.

**TL;DR:** You can define `WXSUPPRESS_SIZER_FLAGS_CHECK` environment variable
to avoid these asserts if you just want to run the program, e.g. do
```shell
export WXSUPPRESS_SIZER_FLAGS_CHECK=1
```
before running it.

And if you're the program developer, it is recommended to fix these asserts
which is usually as simple as removing the offending flags that have no effect
anyhow -- but may sometime indicate the previously unknown defects in your
layout, that should be fixed in some more extensive way. In some very extreme
cases (e.g. hundreds of windows auto-generated by some GUI layout tool and
triggering these asserts), you can also call the static
[wxSizerFlags::DisableConsistencyChecks()][3] function to globally disable
these asserts for your programs, but this is strongly _not_ recommended

[1]: https://docs.wxwidgets.org/3.1/overview_debugging.html
[2]: https://github.com/wxWidgets/wxWidgets/commit/1d6c740f3b35def74374505d13ca34d37f7d6808
[3]: https://docs.wxwidgets.org/trunk/classwx_sizer_flags.html#a6c99f94314f84fc8c78cd1d9345b9950
